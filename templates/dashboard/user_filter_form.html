<form method="get" class="container mb-3" id="filterForm">
  <div class="row align-items-end">

    <!-- Username Filter (Live Search) -->
    <div class="col-md-4">
      <label for="id_username" class="form-label">Username</label>
      <input
        type="text"
        class="form-control"
        id="id_username"
        name="username"
        value="{{ selected_username }}"
        placeholder="Search by username"
        oninput="onSubmit()"
      />
    </div>

    <!-- Role Filter -->
    <div class="col-md-4">
      <label for="id_role" class="form-label">Role</label>
      <select name="role" id="id_role" class="form-control" onchange="this.form.submit()">
        <option value="">All Roles</option>
        <option value="admin" {% if selected_role == "admin" %}selected{% endif %}>Admin</option>
        <option value="manager" {% if selected_role == "manager" %}selected{% endif %}>Manager</option>
        <option value="employee" {% if selected_role == "employee" %}selected{% endif %}>Employee</option>
      </select>
    </div>

    <!-- Clear Button -->
    <div class="col-md-4">
      <a href="{% url 'user_table' %}" class="btn btn-secondary mt-4 w-100">
        Clear
      </a>
    </div>

  </div>
</form>

<!-- Delay auto-submit when typing -->
<script>
  let timeout = null;
  function onSubmit() {
    clearTimeout(timeout);
    timeout = setTimeout(() => {
      document.getElementById('filterForm').submit();
    }, 500);
  }
</script>
